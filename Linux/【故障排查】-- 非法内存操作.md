### 概述

本文以 c 环境为基础，讨论非法内存操作导致的 SIGSEGV/segmentation fault 程序异常结束和对应调试方法。因为很多语言或者组件都是 c 写的，所以如何解决这些内存问题也算是一个通用的技能了。

本文的思路为：通过 GDB 识别内存问题 --> 通过 Valgrind 定位内存问题。

*注意：下面默认 GDB 调试依赖了 core dump 文件，且被调试的程序都加了 -g 参数去编译构建。*

---

### 通过 GDB 识别内存问题

#### 1. 栈溢出

常见于超出了栈大小的递归调用。

通过 GDB 可以看到同一个函数被同一个地址重复调用，演示如下：

![](https://raw.githubusercontent.com/hsxhr-10/picture/master/栈溢出1.png)

#### 2. 栈被破坏

常见于多线程环境下的线程冲突、向以分配的内存空间之外写数据。

通过 GDB 可以看到 backtrace 的信息异常，演示如下：

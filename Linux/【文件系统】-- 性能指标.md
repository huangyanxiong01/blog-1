文件系统为内核和磁盘设备之间的数据交流提供了接口，Linux 作为一个开源的操作系统，本身是可以支持不同的文件系统，用户可以根据自身的需求选择不同特性的文件系统。
常见的文件系统有 ext2, ext3, ext4, proc, NFS, JFS, FAT 等。

---

### <font color=#00b0f0>虚拟文件系统</font>

虚拟文件系统是一个处于用户空间和文件系统之间的抽象层，虚拟文件系统对于需要访问的文件系统对象提供了通用的对象模型 (元数据, 文件数据)。同时还隐藏了不同文件系统之间的差异性，使得内核空间和用户空间不需要关心使用的到底是哪种文件系统，在切换文件系统后也无需修改内核空间和用户空间。下图显示了虚拟文件系统在操作系统中
的位置 (灵魂画手上线)：

![](https://raw.githubusercontent.com/hsxhr-10/picture/master/vfs.jpeg)

在用户眼里，文件系统就是一颗目录树。而实际上虚拟文件系统提供的对象模型并不是一颗树，而是下图的结构：

![](https://raw.githubusercontent.com/hsxhr-10/picture/master/fs-obj-model.jpeg)

比如执行 `cat /dir1/file1` 的查找过程如下：
1. 虚拟文件系统根据 dir1 这个文件名找到 inode 编号 10
2. 根据 inode 编号 10 找到对应的 data pooling
3. 根据 data pooling 中的 `file1 --> 12` 得到 file1 的 inode 编号 12
4. 根据 inode 编号 12 找到对应的 data pooling `a`

---

### <font color=#00b0f0>ext2/ext3/ext4 区别</font>

extX 系列是 Linux 默认的文件系统，X 越大代表是越新的文件系统，这些文件系统之间是向后兼容，各有特点，不能粗暴地认定 ext3 就一定比 ext2 要好，因为在某些
特殊使用场景下，可能旧版本的反而表现会更好。

#### ext2 和 ext3 的不完全对比

- ext3 比 ext2 多了日志系统，因为日志系统的存在，在系统崩溃后的重启时，系统无需扫描整个文件系统就可以定位数据不一致的地方，大大加快了重启的速度
- 对于写操作，ext2 先将数据写入缓存中，等到缓存满了之后写入磁盘，而 ext3 也是先将数据写入缓存，等到缓存满了之后写入日志系统，然后写入磁盘，等成功写入磁盘之后擦除对应日志

> 可靠性方面 ext3 > ext2；写性能则是 ext2 > ext3

#### ext3 和 ext4 的不完全对比

- ext4 比 ext3 支持容量更大的文件系统，ext3 支持 16TB 的文件系统，ext4 支持 1EB (1,048,576TB，1EB=1024PB，1PB=1024TB) 的文件系统
- ext4 支持无限数量的子目录，ext3 支持 32000 个子目录，而 ext4 则支持无限个
- 性能方面，ext4 分配数据块方更高效，因为可以分配连续的数据块，减少数据块的分配次数；ext4 中 fsck 的速度更快
- ext4 支持检查日志数据是否损坏
- ext4 支持无日志模式
- ext4 支持碎片整理

> 总的来说，在性能、可靠性、功能方面，ext4 比 ext3 都要好
